(this.webpackJsonpreact=this.webpackJsonpreact||[]).push([[0],{169:function(t,e,n){},277:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n(146),i=(n(168),n(169),n(28)),s=n(11),o=n(19),c=n(6),u=n.n(c),l=n(18),d=n(16),p=n(17),h=(n(120),n(66)),f=n.n(h),g=n(67),b=n.n(g),k=n(43),j=n.n(k),w=n(29),x=n.n(w),O=[],v=[],m=[],y=function(){function t(e){Object(d.a)(this,t),this.id=null,this.orchestratorId=null,this._status="pending",this.createdAt=null,this.lastUpdatedAt=null,this.startedAt=null,this.orgSlug=null,this.pipelineId=null,this.pipelineConfig={},this.protocol=null,this.tasks=[],this.id=e.pipelineId+"-"+t.idCounter++,this.createdAt=(new Date).toISOString(),this.lastUpdatedAt=(new Date).toISOString(),Object.assign(this,e)}return Object(p.a)(t,[{key:"status",get:function(){return this._status},set:function(t){this._status=t,this.lastUpdatedAt=(new Date).toISOString()}}],[{key:"getNForEnqueuer",value:function(t){for(var e=[],n=O.filter((function(t){return"pending"===t.status})),r=Object.values(x()(n,"pipelineId")),a=!1;!a;){a=!0;var i,s=Object(l.a)(r);try{for(s.s();!(i=s.n()).done;){var o=i.value.find((function(t){return"pending"===t.status}));if(o&&(o.status="queued",e.push(o),a=!1),e.length>=t)return e}}catch(c){s.e(c)}finally{s.f()}}return e}},{key:"getPendingForTheOrchestrator",value:function(t){return O.filter((function(e){return"pending"===e.status&&e.orchestratorId===t}))}}]),t}();y.idCounter=1;var S=function(){function t(e){Object(d.a)(this,t),this.id=null,this.workflow=null,this.taskScript=null,this.taskGroupHash=null,this.type="ecs",this.duration=5e3,this._status="pending",this.createdAt=null,this.startedAt=null,this.lastUpdatedAt=null,this.container=null,this.id=t.idCounter++,this.createdAt=(new Date).toISOString(),this.lastUpdatedAt=(new Date).toISOString(),Object.assign(this,e)}return Object(p.a)(t,[{key:"status",get:function(){return this._status},set:function(t){this._status=t,this.lastUpdatedAt=(new Date).toISOString()}}],[{key:"poll",value:function(t){var e=v.filter((function(e){return e.taskGroupHash===t&&"pending"===e.status})),n=Object(o.a)(e,1)[0];return n?(n.startedAt=(new Date).toISOString(),n.status="in-progress",n):null}}]),t}();S.idCounter=1;var C=function(){function t(e){Object(d.a)(this,t),this.id=null,this.taskGroupHash=null,this.pipelineId=null,this.type="ecs",this.duration=5e3,this.progress=0,this._status="creating",this.createdAt=null,this.startedAt=null,this.lastUpdatedAt=null,this.runningTask=null,this.reuseCount=0,this.memoryInMB=512,this.id=S.idCounter++,this.createdAt=(new Date).toISOString(),this.lastUpdatedAt=(new Date).toISOString(),Object.assign(this,e)}return Object(p.a)(t,[{key:"status",get:function(){return this._status},set:function(t){this._status=t,this.lastUpdatedAt=(new Date).toISOString()}}],[{key:"listForTaskGroupHash",value:function(t,e){return m.filter((function(n){return n.taskGroupHash===t&&e.includes(n.status)}))}}]),t}();C.idCounter=1;var I=1,D=function(t){return new Promise((function(e){return setTimeout(e,t/I)}))},A=function(){function t(e){Object(d.a)(this,t),this.dbContainer=null,this.type="ecs",this.emptyPolls=0,this.dbContainer=e,this.init()}return Object(p.a)(t,[{key:"init",value:function(){var e=Object(s.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(t.startDelay[this.dbContainer.type]);case 2:this.run();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(){var e=Object(s.a)(u.a.mark((function e(){var n,r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.dbContainer.startedAt=(new Date).toISOString(),this.dbContainer.status="running";case 2:if("running"!==this.dbContainer.status){e.next=29;break}if(!(n=this.pollNewTask())){e.next=23;break}this.dbContainer.runningTask=n,n.container=this.dbContainer,r=n.duration/1e3,a=0;case 9:if(!(a<r)){e.next=16;break}return e.next=12,D(1e3);case 12:n.progress=a/r;case 13:a++,e.next=9;break;case 16:n.progress=1,n.status="completed",this.dbContainer.runningTask=null,this.emptyPolls=0,this.dbContainer.reuseCount++,e.next=25;break;case 23:this.emptyPolls++,this.emptyPolls>t.maxEmptyPolls&&this.stop();case 25:return e.next=27,D(500);case 27:e.next=2;break;case 29:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){this.dbContainer.status="stopped"}},{key:"pollNewTask",value:function(){return S.poll(this.dbContainer.taskGroupHash)}}]),t}();A.startDelay={ecs:5e3,windows:3e4},A.maxEmptyPolls=100;var T=function(){function t(){Object(d.a)(this,t),this.running=!1}return Object(p.a)(t,[{key:"run",value:function(){var t=Object(s.a)(u.a.mark((function t(){var e,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.running=!0,console.log("Checktainer started");case 2:if(!this.running){t.next=15;break}e=x()(v.filter((function(t){return"pending"===t.status})),"taskGroupHash"),t.t0=u.a.keys(e);case 5:if((t.t1=t.t0()).done){t.next=11;break}return n=t.t1.value,t.next=9,this.ensureGroup(n);case 9:t.next=5;break;case 11:return t.next=13,D(1e3);case 13:t.next=2;break;case 15:console.log("Checktainer stopped");case 16:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"stop",value:function(){this.running=!1}},{key:"calcDesiredCreateCount",value:function(t){var e=t.pendingTasksCount,n=t.runningTasksCount;return Math.ceil(e/(n/3+1)/5)}},{key:"ensureGroup",value:function(){var t=Object(s.a)(u.a.mark((function t(e){var n,r,a,i,s,c,l,d,p,h,f;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=v.filter((function(t){return t.taskGroupHash===e&&["pending","in-progress"].includes(t.status)})),r=C.listForTaskGroupHash(e,["creating","running"]).length,a=n.filter((function(t){return"pending"===t.status})),i=Object(o.a)(a,1),s=i[0],c=n.filter((function(t){return"pending"===t.status})).length,l=n.filter((function(t){return"in-progress"===t.status})).length,d=this.calcDesiredCreateCount({pendingTasksCount:c,runningTasksCount:l}),p=d+l-r,h=0;h<p;h++)f=new C({taskGroupHash:e,type:s.type,pipelineId:s.workflow.pipelineId}),m.push(f),new A(f);case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}(),W={enqueuer2Orchestrator:[]},M=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=[];W[t].length&&n.length<e;)n.push(W[t].pop());return n},N=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(d.a)(this,t),this.id=null,this.running=!1,this.newMode=!1,this.reserved=!1,this.runningWorkflows=new Set([]),this.idlingStartedTimestamp=null,this.id=t.idCounter++,this.newMode=e,this.reserved=n}return Object(p.a)(t,[{key:"run",value:function(){var e=Object(s.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(t.startDelay);case 2:if(this.idlingStartedTimestamp=Date.now(),!this.newMode){e.next=7;break}return e.abrupt("return",this.runNew());case 7:return e.abrupt("return",this.runOld());case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"runOld",value:function(){var e=Object(s.a)(u.a.mark((function e(){var n,r,a,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.running=!0,console.log("Orchestrator ".concat(this.id," started"));case 2:if(!this.running){e.next=28;break}if(!(this.runningWorkflows.size<t.runningWorkflowsMax)){e.next=24;break}n=M("enqueuer2Orchestrator",t.runningWorkflowsMax-this.runningWorkflows.size),r=Object(l.a)(n),e.prev=6,r.s();case 8:if((a=r.n()).done){e.next=16;break}if(i=a.value,this.runningWorkflows.add(i),this.runWorkflow(i),this.running){e.next=14;break}return e.abrupt("break",16);case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),r.e(e.t0);case 21:return e.prev=21,r.f(),e.finish(21);case 24:return e.next=26,D(1e3);case 26:e.next=2;break;case 28:console.log("Orchestrator ".concat(this.id," stopped"));case 29:case"end":return e.stop()}}),e,this,[[6,18,21,24]])})));return function(){return e.apply(this,arguments)}}()},{key:"runNew",value:function(){var t=Object(s.a)(u.a.mark((function t(){var e,n,r,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.running=!0,console.log("Orchestrator ".concat(this.id," started (new mode)"));case 2:if(!this.running){t.next=28;break}e=y.getPendingForTheOrchestrator(this.id),n=Object(l.a)(e),t.prev=5,n.s();case 7:if((r=n.n()).done){t.next=16;break}if(a=r.value,this.idlingStartedTimestamp=null,this.runningWorkflows.add(a),this.runWorkflow(a),this.running){t.next=14;break}return t.abrupt("break",16);case 14:t.next=7;break;case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(5),n.e(t.t0);case 21:return t.prev=21,n.f(),t.finish(21);case 24:return t.next=26,D(1e3);case 26:t.next=2;break;case 28:console.log("Orchestrator ".concat(this.id," stopped"));case 29:case"end":return t.stop()}}),t,this,[[5,18,21,24]])})));return function(){return t.apply(this,arguments)}}()},{key:"stop",value:function(){this.running=!1}},{key:"runWorkflow",value:function(){var t=Object(s.a)(u.a.mark((function t(e){var n,r,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.orchestratorId=this.id,e.status="in-progress",e.startedAt=(new Date).toISOString(),n=Object(l.a)(e.protocol.steps),t.prev=4,n.s();case 6:if((r=n.n()).done){t.next=12;break}return a=r.value,t.next=10,this.runTask(e,a);case 10:t.next=6;break;case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(4),n.e(t.t0);case 17:return t.prev=17,n.f(),t.finish(17);case 20:e.status="completed",this.runningWorkflows.delete(e),this.runningWorkflows.size||(this.idlingStartedTimestamp=Date.now());case 23:case"end":return t.stop()}}),t,this,[[4,14,17,20]])})));return function(e){return t.apply(this,arguments)}}()},{key:"runTask",value:function(){var t=Object(s.a)(u.a.mark((function t(e,n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=new S({workflow:e,image:n.image,taskGroupHash:[e.orgSlug,e.pipelineId,n.type,n.taskScript].join("-"),type:n.type,duration:n.duration}),v.push(r),e.tasks.push(r);case 3:if(!["pending","in-progress"].includes(r.status)){t.next=8;break}return t.next=6,D(1e3);case 6:t.next=3;break;case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"idlingDuration",get:function(){return this.idlingStartedTimestamp?Date.now()-this.idlingStartedTimestamp:0}}]),t}();N.idCounter=1,N.runningWorkflowsMax=10,N.startDelay=5e3;var U,P,z=n(147),G=n.n(z),H=n(95),_=n.n(H),B=function(){function t(e){Object(d.a)(this,t),this.running=!1,this.maxOrchestrators=8,this.platform=null,this.noScaleUpCounter=0,this.platform=e}return Object(p.a)(t,[{key:"getMaxWorkflowsPerPipeline",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1?arguments[1]:void 0;return Math.ceil(e/t)}},{key:"run",value:function(){var t=Object(s.a)(u.a.mark((function t(){var e,n,r,a,i,s,c,d,p,h,f,g,b,k,j,w,v,m;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.running=!0,console.log("Scheduler started");case 2:if(!this.running){t.next=61;break}if(e=N.runningWorkflowsMax*this.platform.orchestrators.length,n=O.filter((function(t){return["pending","in-progress"].includes(t.status)})),!(r=Object.values(x()(n,"pipelineId"))).length){t.next=52;break}a=this.getMaxWorkflowsPerPipeline(r.length,e),i=!1;case 9:if(i){t.next=52;break}i=!0,s=Object(l.a)(r),t.prev=12,s.s();case 14:if((c=s.n()).done){t.next=42;break}if(d=c.value,!(d.filter((function(t){return t.orchestratorId})).length<a)){t.next=40;break}if(p=d.find((function(t){return!t.orchestratorId}))){t.next=21;break}return t.abrupt("continue",40);case 21:h=_()(this.platform.orchestrators,(function(t){return O.filter((function(e){return["pending","in-progress"].includes(e.status)&&e.orchestratorId===t.id})).length})),f=Object(l.a)(h),t.prev=23,b=function(){var t=g.value;if(O.filter((function(e){return["pending","in-progress"].includes(e.status)&&e.orchestratorId===t.id})).length<N.runningWorkflowsMax)return p.orchestratorId=t.id,i=!1,"break"},f.s();case 26:if((g=f.n()).done){t.next=32;break}if("break"!==b()){t.next=30;break}return t.abrupt("break",32);case 30:t.next=26;break;case 32:t.next=37;break;case 34:t.prev=34,t.t0=t.catch(23),f.e(t.t0);case 37:return t.prev=37,f.f(),t.finish(37);case 40:t.next=14;break;case 42:t.next=47;break;case 44:t.prev=44,t.t1=t.catch(12),s.e(t.t1);case 47:return t.prev=47,s.f(),t.finish(47);case 50:t.next=9;break;case 52:return k=O.filter((function(t){return["pending","in-progress"].includes(t.status)&&t.orchestratorId})).length,j=O.filter((function(t){return!t.orchestratorId})),(w=j.length)>0&&k+w>e&&k>.8*e&&(v=Object(o.a)(j,1),m=v[0],Date.now()-new Date(m.createdAt).getTime()>3e4&&this.platform.orchestrators.length<this.maxOrchestrators&&0===this.noScaleUpCounter&&(this.platform.incNumOfOrchestrators(),this.noScaleUpCounter=10)),this.noScaleUpCounter>0&&this.noScaleUpCounter--,t.next=59,D(1e3);case 59:t.next=2;break;case 61:console.log("Scheduler stopped");case 62:case"end":return t.stop()}}),t,this,[[12,44,47,50],[23,34,37,40]])})));return function(){return t.apply(this,arguments)}}()},{key:"stop",value:function(){this.running=!1}}]),t}(),F=function(){function t(){Object(d.a)(this,t),this.running=!1,this.orchestrators=[new N(!0,!0),new N(!0,!0)],this.checktainer=new T,this.scheduler=null,this.scheduler=new B(this)}return Object(p.a)(t,[{key:"addWorkflows",value:function(t){var e;(e=O).push.apply(e,Object(i.a)(t.map((function(t){return new y(t)}))))}},{key:"incNumOfOrchestrators",value:function(){this.setNumOfOrchestrators(this.orchestrators.length+1)}},{key:"setNumOfOrchestrators",value:function(t){if(this.orchestrators.length<t)for(var e=this.orchestrators.length;e<t;e++){var n=new N(!0);this.orchestrators.push(n),this.running&&n.run()}else for(var r=this.orchestrators.length;r>t;r--)this.orchestrators.pop().stop()}},{key:"setMaxWorkflowsPerOrchestrator",value:function(t){N.runningWorkflowsMax=t}},{key:"run",value:function(){var t=Object(s.a)(u.a.mark((function t(){var e,n,r,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=Object(l.a)(this.orchestrators);try{for(e.s();!(n=e.n()).done;)n.value.run()}catch(i){e.e(i)}finally{e.f()}this.checktainer.run(),this.scheduler.run(),this.running=!0,console.log("Platform started");case 6:if(!this.running){t.next=12;break}return G()(this.orchestrators,(function(t){return!t.reserved&&t.idlingDuration>2e4&&!t.runningWorkflows.size&&(t.stop(),!0)})),t.next=10,D(1e3);case 10:t.next=6;break;case 12:r=Object(l.a)(this.orchestrators);try{for(r.s();!(a=r.n()).done;)a.value.stop()}catch(i){r.e(i)}finally{r.f()}this.checktainer.stop(),this.scheduler.stop(),console.log("Platform stopped");case 17:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"stop",value:function(){this.running=!1}},{key:"getStats",value:function(t){var e=O.filter((function(e){return e.pipelineId===t})),n=v.filter((function(e){return e.workflow.pipelineId===t})),r=m.filter((function(e){return e.pipelineId===t})),a=e.filter((function(t){return"completed"===t.status})).map((function(t){return{duration:new Date(t.lastUpdatedAt).getTime()-new Date(t.startedAt).getTime(),waiting:new Date(t.startedAt).getTime()-new Date(t.createdAt).getTime()}}));return{workflows:j()(e,"status"),tasks:j()(n,"status"),containers:j()(r,"status"),idlingContainers:r.filter((function(t){return"running"===t.status&&!t.runningTask})).length,times:a.length?{durationMin:f()(a,"duration").duration/1e3,durationMax:b()(a,"duration").duration/1e3,waitingMin:f()(a,"waiting").waiting/1e3,waitingMax:b()(a,"waiting").waiting/1e3}:{}}}},{key:"state",get:function(){return{workflowsByStatus:x()(O,"status"),orchestrators:this.orchestrators.map((function(t){return{id:t.id,workflows:O.filter((function(e){return e.orchestratorId===t.id&&["pending","queued","in-progress"].includes(e.status)}))}})),containers:m.filter((function(t){return["creating","running"].includes(t.status)}))}}},{key:"getStartedWorkflows",value:function(){return O.filter((function(t){return t.startedAt}))}},{key:"getStartedTasks",value:function(){return v.filter((function(t){return t.startedAt&&t.container}))}},{key:"getContainers",value:function(){return m}}]),t}(),q=n(46),E=n(278),L=n(293),R=n(298),J=n(84),K=n(73),Z=n(151),Q=n(118),V=n(64),X=n(119),Y=n(297),$=n(295),tt=n(296),et=n(148),nt=n.n(et),rt=n(71),at=n.n(rt),it=n(86),st=n(2),ot=0,ct=function(){U||(U=new F);var t=Object(r.useRef)(null),e=Object(r.useState)(!1),n=Object(o.a)(e,2),a=n[0],c=n[1],l=Object(r.useState)(null),d=Object(o.a)(l,2),p=d[0],h=d[1],f=Object(r.useState)(null),g=Object(o.a)(f,2),b=g[0],k=g[1],j=Object(r.useState)(1),w=Object(o.a)(j,2),x=w[0],O=w[1],v=Object(r.useState)(2),m=Object(o.a)(v,2),y=m[0],S=m[1],C=Object(r.useState)(10),D=Object(o.a)(C,2),A=D[0],T=D[1],W=Object(r.useState)(50),M=Object(o.a)(W,2),N=(M[0],M[1],Object(r.useState)(100)),z=Object(o.a)(N,2),G=z[0],H=z[1],B=function(){var t=Object(s.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c(!0),U.run();case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),et=function(){var t=Object(s.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return U.stop(),c(!1),t.next=4,rt();case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),rt=function(){var e=Object(s.a)(u.a.mark((function e(){var n,r,a,s,o,c,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h({black:U.getStats("black"),red:U.getStats("red"),blue:U.getStats("blue")}),k(U.state),S(U.orchestrators.length),P?U.running&&ot?(n=U.getStartedTasks(),r=n.map((function(t){return{id:t.id,group:t.container.id,title:"task-".concat(t.id),content:"task-".concat(t.id),start:new Date(t.startedAt),end:"completed"!==t.status?new Date:new Date(t.lastUpdatedAt),type:"range",selectable:!1,style:"border-color: black; background-color: ".concat(t.workflow.pipelineId,"; opacity: 0.8; color: white;")}})),a=U.getContainers(),r.push.apply(r,Object(i.a)(a.map((function(t){return{id:"c-".concat(t.id),group:t.id,start:new Date(t.createdAt),end:"stopped"!==t.status?new Date:new Date(t.lastUpdatedAt),type:"background",selectable:!1,style:"background-color: ".concat(t.pipelineId,"; opacity: 0.3;")}})))),s=new it.a(a.map((function(t,e){return{id:t.id,index:e,content:"<small>".concat("ecs"===t.type?"ecs":"win"," ").concat(t.memoryInMB,"MB</small>"),style:"color: ".concat(t.pipelineId,";")}}))),P.setData({groups:s,items:r})):(o=_()(U.getStartedWorkflows(),(function(t){return new Date(t.startedAt).getTime()})),(c=o.map((function(t){return{id:t.id,group:t.id,title:t.id,content:t.id,start:new Date(t.startedAt),end:"completed"!==t.status?new Date:new Date(t.lastUpdatedAt),type:"background",selectable:!1,style:"border-color: black; background-color: ".concat(t.pipelineId,"; opacity: 0.8; color: white;")}}))).push.apply(c,Object(i.a)(o.map((function(t){return{id:"".concat(t.id,"-created"),group:t.id,title:t.id,start:new Date(t.createdAt),type:"point",selectable:!1,className:"timeline-point-".concat(t.pipelineId)}})))),c.push.apply(c,Object(i.a)(o.reduce((function(t,e){return t.push.apply(t,Object(i.a)(e.tasks.filter((function(t){return t.startedAt})).map((function(t){return{id:"task-".concat(t.id),group:e.id,title:"".concat(t.id),start:new Date(t.startedAt),end:"completed"!==t.status?new Date:new Date(t.lastUpdatedAt),type:"range",selectable:!1,style:"border-color: white; background: none; color: white;"}})))),t}),[]))),l=new it.a(o.map((function(t,e){return{id:t.id,index:e,content:""}}))),P.setData({groups:l,items:c})):P=new it.b(t.current,[],new it.a([]),{orientation:{axis:"both",item:"top"},groupOrder:"index",zoomFriction:20,preferZoom:!1,stack:!1,groupHeightMode:"fixed",tooltip:{followMouse:!0,delay:100},horizontalScroll:!0,verticalScroll:!0,zoomKey:"ctrlKey",start:new Date,end:new Date(Date.now()+3e5)});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ct=function(t){U.addWorkflows(nt()(G,(function(e){var n=t[at()(0,t.length-1)];return{orgSlug:"st-org",pipelineId:n,protocol:{id:"someid",steps:{red:[{type:"ecs",duration:1e3*at()(1,8),taskScript:"ts1"},{type:"windows",duration:5e3*at()(1,5),taskScript:"ts2"}],blue:[{type:"ecs",duration:1e3*at()(1,5),taskScript:"ts4"}],black:[{type:"ecs",duration:1e3*at()(100,200),taskScript:"ts5"}]}[n]}}})))},ut=function(t){return Object(st.jsxs)(st.Fragment,{children:["windows"===t.type&&Object(st.jsx)(q.a,{name:"windows",className:"pull-right",color:t.pipelineId,disabled:!0}),"ecs"===t.type&&Object(st.jsx)(q.a,{name:"linux",className:"pull-right",color:t.pipelineId,disabled:!0})]})};return Object(r.useEffect)((function(){var t=setInterval(rt,1e3);return rt(),function(){clearInterval(t)}}),[]),Object(st.jsxs)("div",{style:{padding:"14px 62px"},children:[Object(st.jsx)("style",{children:"\n       .timeline-point-blue { border-color: blue; }\n       .timeline-point-red { border-color: red; }\n       .timeline-point-black { border-color: black; }\n      "}),Object(st.jsx)("h3",{children:"New architecture simulation"}),Object(st.jsxs)("div",{children:[Object(st.jsx)(E.a,{disabled:a,loading:a,onClick:function(){return B()},children:"RUN"}),"\xa0",Object(st.jsx)(E.a,{disabled:!a,onClick:function(){return et()},children:"STOP"}),Object(st.jsx)(L.a,{type:"number",size:"mini",label:"speed",min:"1",max:"100",step:"1",value:x,onChange:function(t){var e;O(t.target.value),e=1*t.target.value||1,I=e},style:{marginLeft:"30px"}}),Object(st.jsx)(L.a,{type:"number",size:"mini",label:"orchestrators",min:"1",max:"8",step:"1",value:y,onChange:function(t){U.setNumOfOrchestrators(1*t.target.value||1),S(U.orchestrators.length)},style:{marginLeft:"4px"}}),Object(st.jsx)(L.a,{type:"number",size:"mini",label:"workflows per orchestrator",min:"1",max:"100",step:"1",value:A,onChange:function(t){T(t.target.value),U.setMaxWorkflowsPerOrchestrator(1*t.target.value||1)},style:{marginLeft:"4px"}}),!1,Object(st.jsx)(E.a,{className:"pull-right",style:{marginLeft:"14px"},onClick:function(){return ct(["blue","red","black"])},children:"+mix"}),Object(st.jsx)(E.a,{className:"pull-right",color:"blue",onClick:function(){return ct(["blue"])},children:"+"}),Object(st.jsx)(E.a,{className:"pull-right",color:"red",onClick:function(){return ct(["red"])},children:"+"}),Object(st.jsx)(E.a,{className:"pull-right",color:"black",onClick:function(){return ct(["black"])},children:"+"}),Object(st.jsx)(L.a,{type:"number",label:"to create",min:"1",max:"100",step:"1",value:G,onChange:function(t){H(t.target.value)},className:"pull-right",style:{marginRight:"8px"}})]}),Object(st.jsx)("div",{style:{marginTop:"10px"},children:b&&Object(st.jsxs)(R.a,{children:[Object(st.jsx)(J.a,{children:Object(st.jsxs)(K.a,{children:[Object(st.jsxs)(Z.a,{width:"1",children:["Pending [",(b.workflowsByStatus.pending||[]).length,"]"]}),!1,b.orchestrators.map((function(t,e){return Object(st.jsxs)(Z.a,{width:"2",children:["Orch #",e+1," [",t.workflows.length,"]"]},t.id)})),Object(st.jsxs)(Z.a,{width:"2",children:["Containers [",b.containers.length,"]"]}),Object(st.jsx)(Z.a,{width:"2",children:"Stats"})]})}),Object(st.jsx)(Q.a,{children:Object(st.jsxs)(K.a,{children:[Object(st.jsx)(V.a,{verticalAlign:"top",children:(b.workflowsByStatus.pending||[]).map((function(t){return Object(st.jsx)("div",{style:{margin:"2px"},children:Object(st.jsx)(X.a,{size:"tiny",color:t.pipelineId,children:t.id})},t.id)}))}),!1,b.orchestrators.map((function(t){return Object(st.jsx)(V.a,{verticalAlign:"top",children:t.workflows.map((function(t){return Object(st.jsx)("div",{children:Object(st.jsx)(Y.a.Group,{horizontal:!0,size:"tiny",children:t.tasks.map((function(e){return Object(st.jsxs)(Y.a,{compact:!0,color:t.pipelineId,children:[t.id,"-",e.id,"pending"===e.status&&Object(st.jsx)(q.a,{name:"hourglass",className:"pull-right",color:t.pipelineId,disabled:!0}),"in-progress"===e.status&&Object(st.jsx)($.a,{percent:100*e.progress,size:"tiny",style:{margin:"4px 0 0"},color:t.pipelineId})]},e.id)}))})},t.id)}))},t.id)})),Object(st.jsx)(V.a,{verticalAlign:"top",children:(b.containers||[]).map((function(t){return"creating"===t.status?Object(st.jsxs)(Y.a,{color:t.pipelineId,children:["Creating ",t.type,"...",ut(t)]},t.id):t.runningTask?Object(st.jsxs)(Y.a,{color:t.pipelineId,children:[t.runningTask.workflow.id,"-",t.runningTask.id," [",t.reuseCount,"]",ut(t),Object(st.jsx)($.a,{percent:100*t.runningTask.progress,size:"tiny",style:{margin:"4px 0 0"},color:t.pipelineId})]},t.id):Object(st.jsxs)(Y.a,{color:t.pipelineId,children:["Idling [",t.reuseCount,"]",ut(t)]},t.id)}))}),Object(st.jsx)(V.a,{verticalAlign:"top",children:["black","red","blue"].map((function(t){return Object(st.jsx)(Y.a,{color:t,children:Object(st.jsx)("pre",{style:{color:t},children:JSON.stringify(p[t],null,2)})},t)}))})]})})]})}),Object(st.jsx)("div",{style:{marginTop:"10px"},children:Object(st.jsx)(tt.a,{toggle:!0,label:ot?"Containers timeline":"Workflows timeline",onChange:function(){ot=1-ot,rt()},value:ot})}),Object(st.jsx)("div",{ref:t,style:{marginTop:"10px"}})]})};function ut(){return Object(st.jsx)("div",{className:"App",children:Object(st.jsx)(ct,{})})}var lt=document.getElementById("root");Object(a.createRoot)(lt).render(Object(st.jsx)(r.StrictMode,{children:Object(st.jsx)(ut,{})}))}},[[277,1,2]]]);
//# sourceMappingURL=main.5163459a.chunk.js.map